
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Using Python From Tcl &#8212; Tohil 4.0 documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pydoctheme.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    
    <script src="../_static/sidebar.js"></script>
    
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within Tohil 4.0 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="The Tohil Library" href="../reference/index.html" />
    <link rel="prev" title="Using Tcl from Python" href="tohil_python.html" />
    <link rel="canonical" href="https://docs.python.org/3/tutorial/tohil_tcl.html" />
    
      
    

    
    <style>
      @media only screen {
        table.full-width-table {
            width: 100%;
        }
      }
    </style>
<link rel="shortcut icon" type="image/png" href="../_static/tohil.png" />
            <script type="text/javascript" src="../_static/copybutton.js"></script>
            <script type="text/javascript" src="../_static/menu.js"></script> 

  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <label for="menuToggler" class="toggler__label">
        <span></span>
    </label>
    <nav class="nav-content" role="navigation">
         <a href="https://github.com/flightaware/tohil" class="nav-logo">
             <img src="../_static/tohil.png" alt="Logo"/>
         </a>
        <div class="version_switcher_placeholder"></div>
        <form id="searchbox" role="search" class="search" action="../search.html" method="get">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                <path fill-rule="nonzero"
                        d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#444"></path>
            </svg>
            <input type="text" name="q" aria-label="Quick search"/>
            <input type="submit" value="Go"/>
        </form>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using Python From Tcl</a><ul>
<li><a class="reference internal" href="#tohil-eval">tohil::eval</a></li>
<li><a class="reference internal" href="#tohil-exec">tohil::exec</a></li>
<li><a class="reference internal" href="#tohil-import">tohil::import</a></li>
<li><a class="reference internal" href="#notes-about-exec">notes about exec</a></li>
<li><a class="reference internal" href="#tohil-run">tohil::run</a></li>
<li><a class="reference internal" href="#tohil-call">tohil::call</a></li>
<li><a class="reference internal" href="#tohil-interact">tohil::interact</a></li>
<li><a class="reference internal" href="#using-tohil-from-rivet">Using tohil from Rivet</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tohil_python.html"
                        title="previous chapter">Using Tcl from Python</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../reference/index.html"
                        title="next chapter">The Tohil Library</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Report a Bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/master/Doc/tutorial/tohil_tcl.rst"
            rel="nofollow">Show Source
        </a>
      </li>
    </ul>
  </div>
        </nav>
    </div>
</div>

  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../reference/index.html" title="The Tohil Library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tohil_python.html" title="Using Tcl from Python"
             accesskey="P">previous</a> |</li>

          <li><img src="../_static/tohil.png" alt="tohil logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://github.com/flightaware/tohil">Tohil</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">4.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">The Tohil Tutorial</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using Python From Tcl</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="using-python-from-tcl">
<span id="tutorial-python-from-tcl"></span><h1>Using Python From Tcl<a class="headerlink" href="#using-python-from-tcl" title="Permalink to this headline">¶</a></h1>
<p>In this section we’ll introduce using Python from Tcl.</p>
<p>Hopefully you’ve got Tcl and Python and Tohil installed and you can
follow along and try stuff out.</p>
<p>Let’s fire up Tcl and mess around with Python:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>$ tclsh
% package require tohil
4.0.0
</pre></div>
</div>
<p>OK, good news, we’ve got a working Tcl and Tohil.</p>
<p>If the package-require failed then please visit
the installation instructions and get tohil built and installed
on your computer.</p>
<div class="section" id="tohil-eval">
<h2>tohil::eval<a class="headerlink" href="#tohil-eval" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="nb">eval</span> <span class="s2">&quot;37 + 5&quot;</span>
<span class="mi">42</span>
</pre></div>
</div>
<p>That may not look like much, but Tohil got Python to add 37 and 5 for us
and returned the result back to tcl.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>% set answer [tohil::eval &quot;37 + 5&quot;]
42
% puts $answer
42
</pre></div>
</div>
</div>
<div class="section" id="tohil-exec">
<h2>tohil::exec<a class="headerlink" href="#tohil-exec" title="Permalink to this headline">¶</a></h2>
<p>In Python, <em>eval</em> evaluates a single expression and returns the
result, so even trying to eval something like <code class="docutils literal notranslate"><span class="pre">answer</span> <span class="pre">=</span> <span class="pre">42</span></code> is
an error.  Python provides <em>exec</em>, which can evaluate an aribtrary
code block, and Tohil hews to that by providing <em>tohil::exec</em>.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="n">exec</span> <span class="s2">&quot;answer = 37 + 5&quot;</span>
<span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="n">exec</span> <span class="s2">&quot;print(answer)&quot;</span>
<span class="mi">42</span>
</pre></div>
</div>
<p>OK, that’s pretty cool.  Tohil is getting Python to do stuff
for us from Tcl.  Yay.</p>
<p>(A quick note, <em>tohil::eval</em> and <em>tohil::exec</em> are named and work the
way Python’s <em>eval</em> and <em>exec</em> work.  Tcl has its own <em>eval</em> for
evaluating Tcl stuff. It is for Tcl something closer to Python’s <em>exec</em>,
except that Tcl’s <em>eval</em> returns a result, while Tcl’s <em>exec</em> runs programs
and returns their output, something much different.)</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">expr</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">4</span>
<span class="mi">1</span>
<span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="nb">eval</span> <span class="s2">&quot;5 / 4&quot;</span>
<span class="mf">1.25</span>
<span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="nb">eval</span> <span class="s2">&quot;5 // 4&quot;</span>
<span class="mi">1</span>
<span class="o">%</span> <span class="n">expr</span> <span class="mi">5</span> <span class="o">//</span> <span class="mi">4</span>
<span class="n">missing</span> <span class="n">operand</span> <span class="n">at</span> <span class="n">_</span><span class="nd">@_</span>
<span class="ow">in</span> <span class="n">expression</span> <span class="s2">&quot;5 /_@_/ 4&quot;</span>
<span class="k">while</span> <span class="n">evaluating</span> <span class="n">expr</span> <span class="mi">5</span> <span class="o">//</span> <span class="mi">4</span>
</pre></div>
</div>
<p>Yep, it’s Python we’re talking to, all right.  See how Tcl division of
two integers yielded an integer result while Python, a float?  Then
we used Python’s integer division <em>//</em> to get integer division, while
trying that with Tcl was an error because Tcl doesn’t have that operator.</p>
</div>
<div class="section" id="tohil-import">
<h2>tohil::import<a class="headerlink" href="#tohil-import" title="Permalink to this headline">¶</a></h2>
<p>OK, we can start doing Python stuff from Tcl, like import a module.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="n">exec</span> <span class="s2">&quot;import numpy&quot;</span>
</pre></div>
</div>
<p>We do this often enough that Tohil provides a shortcut:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="kn">import</span> <span class="nn">numpy</span>
</pre></div>
</div>
</div>
<div class="section" id="notes-about-exec">
<h2>notes about exec<a class="headerlink" href="#notes-about-exec" title="Permalink to this headline">¶</a></h2>
<p>One thing that can trip people up is it can be surprising that
tohil::exec never returns anything.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="n">exec</span> <span class="s2">&quot;answer = 42&quot;</span>
<span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="n">exec</span> <span class="s2">&quot;answer&quot;</span>
</pre></div>
</div>
<p>The above returns without an error, but doesn’t provide anything.</p>
<p>You instead need to use tohil::eval in this example.  You can call
functions using tohil::eval, by the way.</p>
<p>Though possibly a bit surprising, this behavior is consistent
with how exec works in Python. It probably sbhouldn’t
be a surprise that Tohil is using Python’s
eval and exec mechanisms at the C level to provide these capabilities
to Tcl.</p>
</div>
<div class="section" id="tohil-run">
<h2>tohil::run<a class="headerlink" href="#tohil-run" title="Permalink to this headline">¶</a></h2>
<p>tohil::run is a special version of tohil::exec that grabs anything
Python emits to stdout while the exec is running, and returns it
to the caller.</p>
</div>
<div class="section" id="tohil-call">
<h2>tohil::call<a class="headerlink" href="#tohil-call" title="Permalink to this headline">¶</a></h2>
<p>If you start creating from Tcl, Python to be executed with
eval and exec, you may notice there’s a risk that if you use
substitute-in data, you know, such as names, addresses, cities
or whatever, that unless you are very careful, various characters
can cause your Python not to parse properly.  For example, a single
quote in a name, quotes in general, and other stuff.</p>
<p>Tohil provides <em>tohil::call</em> to make it possible to call a Python
function and make sure that the arguments you pass to the function
are not interpreted by Python along the way.</p>
<p>tohil::call provides a way to invoke one Python function, with zero or more
arguments, without having to pass it through Python’s eval or exec and running
the risk that Python metacharacters appearing in the data will cause quoting
problems, accidental code execution, etc.</p>
<p>tohil::import provides a way to import Python modules, although it’s not much
different from doing a tohil::exec “import module”</p>
</div>
<div class="section" id="tohil-interact">
<h2>tohil::interact<a class="headerlink" href="#tohil-interact" title="Permalink to this headline">¶</a></h2>
<p>Take tohil to eleven.  You’re on ten here… all the way up… You’re
on ten on your guitar… where can you go from there?  Where?  Nowhere.
Exactly.  What we do is if we need that extra… push over the cliff…
you know what we do?</p>
<p>We run <em>tohil::interact</em> from Tcl and enter the Python interactive loop.
When we’re done, we send end of file (^D) to end the Python loop and
return to the Tcl one.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="n">interact</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
<span class="o">...</span>   <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bar&quot;</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="o">^</span><span class="n">D</span>
<span class="o">%</span> <span class="n">tohil</span><span class="p">::</span><span class="nb">eval</span> <span class="n">foo</span><span class="p">()</span>
 <span class="n">bar</span>
</pre></div>
</div>
</div>
<div class="section" id="using-tohil-from-rivet">
<h2>Using tohil from Rivet<a class="headerlink" href="#using-tohil-from-rivet" title="Permalink to this headline">¶</a></h2>
<p>Rivet is an Apache webserver module that provides among other things
a way for webpages to be made from HTML files with embedded Tcl code
that executes when the page is requested.</p>
<p>From a Rivet page, in some of your Tcl code, invoke <cite>package require tohil</cite>.</p>
<p>If you run tohil_rivet it will plug tohil’s Python interpreter such that
everything Python writes to stdout using print, or whatever, will go through
Tcl’s stdout and thereby into your Rivet page.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span>&lt;?

package require tohil; tohil_rivet

puts &quot;calling out to Python to add 5 + 5: [::tohil::eval &quot;5 + 5&quot;]&quot;

tohil::exec {
    print(&#39;hello, world&#39;)
    print(&quot;&lt;hr&gt;&quot;)
}

?&gt;
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Using Python From Tcl</a><ul>
<li><a class="reference internal" href="#tohil-eval">tohil::eval</a></li>
<li><a class="reference internal" href="#tohil-exec">tohil::exec</a></li>
<li><a class="reference internal" href="#tohil-import">tohil::import</a></li>
<li><a class="reference internal" href="#notes-about-exec">notes about exec</a></li>
<li><a class="reference internal" href="#tohil-run">tohil::run</a></li>
<li><a class="reference internal" href="#tohil-call">tohil::call</a></li>
<li><a class="reference internal" href="#tohil-interact">tohil::interact</a></li>
<li><a class="reference internal" href="#using-tohil-from-rivet">Using tohil from Rivet</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tohil_python.html"
                        title="previous chapter">Using Tcl from Python</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../reference/index.html"
                        title="next chapter">The Tohil Library</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../bugs.html">Report a Bug</a></li>
      <li>
        <a href="https://github.com/python/cpython/blob/master/Doc/tutorial/tohil_tcl.rst"
            rel="nofollow">Show Source
        </a>
      </li>
    </ul>
  </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../reference/index.html" title="The Tohil Library"
             >next</a> |</li>
        <li class="right" >
          <a href="tohil_python.html" title="Using Tcl from Python"
             >previous</a> |</li>

          <li><img src="../_static/tohil.png" alt="tohil logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://github.com/flightaware/tohil">Tohil</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
          </li>
    <li id="cpython-language-and-version">
      <a href="../index.html">4.0 Documentation</a> &#187;
    </li>

          <li class="nav-item nav-item-1"><a href="index.html" >The Tohil Tutorial</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">Using Python From Tcl</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="../search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; <a href="../copyright.html">Copyright</a> 2014, Aidan Hobson Sayers, 2021-2021, FlightAware LLC.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="">History and License</a> for more information.
    <br /><br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Last updated on Jun 01, 2021.
    <a href="https://docs.python.org/3/bugs.html">Found a bug</a>?
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.5.4.
    </div>

  </body>
</html>